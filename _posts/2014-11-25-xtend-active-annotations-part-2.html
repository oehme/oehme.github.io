---
layout: post
title: Xtend - Active Annotations Part 2
date: '2014-11-25T16:24:00.003+01:00'
author: Stefan Oehme
tags:
- xtend series
modified_time: '2014-11-26T17:50:22.119+01:00'
blogger_id: tag:blogger.com,1999:blog-7973028861743150658.post-8536810622605487080
blogger_orig_url: http://mnmlst-dvlpr.blogspot.com/2014/11/xtend-active-annotations-part-2.html
---

In the <a href="{{site.baseUrl}}/2014/11/02/xtend-active-annotations-part-1.html">last part of the series</a> we had a look at <a href="http://xtend-lang.org/">Xtend</a>'s built-in Active Annotations. This time you will learn how to write your own Active Annotations to get rid of boilerplate code.<br /><div><br /></div><div>Active Annotations are simply <span style="color: purple;">annotation</span>s marked with <span style="font-family: Trebuchet MS, sans-serif;">@Active</span> and have an associated processor class. The processor gets access to the annotated elements (classes, methods, etc.) during different phases of the Xtend to Java compilation.</div><div><br /></div><div>The corresponding interfaces are</div><div><ul><li><span style="font-family: Trebuchet MS, sans-serif;">RegisterGlobalsParticipant </span>(announces additional types)</li><li><span style="font-family: Trebuchet MS, sans-serif;">TransformationParticipant </span>(changes the Java model)</li><li><span style="font-family: Trebuchet MS, sans-serif;">ValidationParticipant </span>(called after all transformations are done, but before code is generated)</li><li><span style="font-family: Trebuchet MS, sans-serif;">CodeGenerationParticipant </span>(generates additional non-Java code, like XML files etc.)</li></ul><div>There are convenience base classes like <span style="font-family: Trebuchet MS, sans-serif;">AbstractMethodProcessor </span>and&nbsp;<span style="font-family: Helvetica Neue, Arial, Helvetica, sans-serif;">AbstractClassProcessor</span><span style="font-family: inherit;"> that implement all these interfaces.</span></div></div><div><br /></div><div>Let's start with the simple example of adding a logger field to a class. I've seen many people either have a template proposal in the IDE or copy-paste something like this over and over again:</div><div><div><br /></div><script src="https://gist.github.com/oehme/73b8f268c98a91b5e7ce.js"></script> <br /><div>We want to automate this, so we create an Active Annotation and extend <span style="font-family: Trebuchet MS, sans-serif;">AbstractClassProcessor</span>.</div><div><br /></div><script src="https://gist.github.com/oehme/136f24167311087f7cfa.js"></script> <br /><div>As you can see, we get access to the Java AST model as well as lots of helpful methods from the TransformationContext object. Using these, we add the log field to the class and just give it some Java snippet as an initializer. We use a template variable when we want to refer to classes in the generated code. This way, imports are automatically organized for us.</div><div><br /></div><div>Now we can just reuse our @Log annotation everywhere and never have to write the line of boilerplate again. Notice that you cannot use Active Annotations in the same project where they are defined. So put them in a dedicated project that you add as a library to your other projects.</div><div><br /></div><script src="https://gist.github.com/oehme/77e91ef7a27046f2bd2e.js"></script> <br /><div>Just as with the built-in annotations you will notice that the outline, validation, content assist etc. are aware of your new log field. Thanks to the <span style="font-family: Trebuchet MS, sans-serif;">primarySourceElement </span>definition in our processor, navigation works correctly and goes to the class when the log field is selected. You can also take a look at the generated Java code to make sure it matches your expectations. It is automatically updated when you change something in the processor. This very useful when prototyping your own annotations.<br /><br />In the upcoming posts we will build advanced processors and explore the Active Annotation API more thoroughly in the process. If you want to try some examples on your own, you can use <span style="background-color: #cccccc; font-family: Trebuchet MS, sans-serif;">New =&gt; Examples =&gt; Xtend Active Annotation Examples</span>&nbsp;in Eclipse. Or you can have a look at some of my projects, like <a href="https://github.com/oehme/xtend-contrib">xtend-contrib</a> and <a href="https://github.com/oehme/xtend-junit">xtend-junit</a>.</div></div>