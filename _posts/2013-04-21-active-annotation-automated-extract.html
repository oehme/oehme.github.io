---
layout: post
title: ! 'Active Annotation: Automated "extract interface"'
date: '2013-04-21T07:57:00.000+02:00'
author: Stefan Oehme
tags: 
modified_time: '2013-05-22T19:22:54.450+02:00'
blogger_id: tag:blogger.com,1999:blog-7973028861743150658.post-6210438788115675428
blogger_orig_url: http://mnmlst-dvlpr.blogspot.com/2013/04/active-annotation-automated-extract.html
---

This idea for an active annotation came from Oliver Libutzki. He told me that often times<br /><ul><li>he has only one sensible implementation for a piece of code, but wants to hide it behind an interface for easier testing&nbsp;</li><li>the default implementation is so widely used that its API defines the interface while other implementations should follow that</li></ul>I think these are use cases that we all have encountered. This can be done manually by using the "extract interface" refactoring in eclipse and then adding the @ImplementedBy annotation of <a href="https://code.google.com/p/google-guice/">Guice</a> pointing to the default implementation. When you want a different implementation (like in tests), &nbsp;you can overwrite that binding with a Guice module.<br /><br />Since the interface is completely derived from the public methods of its default implementation, this is a prime candidate for automation. So I wrote the @ExtractInterface annotation. It creates an interface that contains all public methods of a class. The name of the interface is the same as the class, with leading "Default" or trailing "Impl" removed. You could just as well prepend an "I", but I'm no big fan of that convention. I'd rather have a clean interface name and a prefix/suffix on the implementing class.<br /><br />The annotation processor for this one is so simple that you should have no problems understanding it after reading the first two paragraphs.<br /><br /><script src="https://gist.github.com/oehme/5428626.js"></script> Well, there is a small problem that currently prevents this from working. The line&nbsp;set("value", cls.newTypeReference) does not compile, because Xtend 2.4.1 does not allow class parameters for annotations. This will most probably change in version 2.4.2, as it is a very common use case.